<ion-content [fullscreen]="true" class="ion-padding bg-primary">
  <ion-refresher slot="fixed" (ionRefresh)="refresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <ion-row>
    <ion-col size="2">
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-back-button defaultHref="/"></ion-back-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-col>
    <ion-col size="6">
      <h2 class="section-header">Account</h2>
    </ion-col>
    <ion-col size="4">
      <button class="top-right-button" (click)="logOut()">
        <ion-icon name="log-out"></ion-icon>
      </button>
    </ion-col>
  </ion-row>

  <ion-progress-bar *ngIf="!userProfile$" type="indeterminate"></ion-progress-bar>

  <ion-item-group class="shadow-none rounded">
    <ion-item-divider>
      <ion-label> Profile </ion-label>
    </ion-item-divider>
    <ion-item (click)="updateName()">
      <ion-label>
        <ion-grid>
          <ion-row>
            <ion-col class="text-left" size="3"> Name: </ion-col>
            <ion-col
              class="text-center"
              size="9"
              *ngIf="(userProfile$ | async )?.fullName"
            >
              {{(userProfile$ | async )?.fullName}}
            </ion-col>
            <ion-col
              size="7"
              class="placeholder-profile text-center"
              *ngIf="!(userProfile$ | async )?.fullName"
            >
              <span> Tap here to edit. </span>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-label>
    </ion-item>

    <ion-item (click)="updateEmail()">
      <ion-label>
        <ion-grid>
          <ion-row>
            <ion-col class="text-left" size="3"> Email: </ion-col>
            <ion-col
              class="text-center"
              size="9"
              *ngIf="(userProfile$ | async )?.email"
            >
              {{(userProfile$ | async )?.email}}
            </ion-col>
            <ion-col
              size="7"
              class="placeholder-profile text-center"
              *ngIf="!(userProfile$ | async )?.email"
            >
              <span> Tap here to edit. </span>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-label>
    </ion-item>

    <!-- <ion-item (click)="updatePassword()">
      <ion-label>
        <ion-grid>
          <ion-row>
            <ion-col class="text-left" size="5"> Password </ion-col>
            <ion-col class="text-center" size="7" class="placeholder-profile">
              <span> Tap here to edit. </span>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-label>
    </ion-item> -->
  </ion-item-group>
  <br />

  <ion-item-divider>
    <ion-label> Activity </ion-label>
  </ion-item-divider>
  <ion-segment [(ngModel)]="selectedSegment" (ionChange)="segmentChanged()">
    <ion-segment-button value="posts">
      <ion-label>Posts</ion-label>
    </ion-segment-button>
    <ion-segment-button value="comments">
      <ion-label>Comments</ion-label>
    </ion-segment-button>
    <ion-segment-button value="stars">
      <ion-label>Stars</ion-label>
    </ion-segment-button>
  </ion-segment>

  <ng-container *ngIf="selectedSegment === 'posts'">
    <ion-item *ngFor="let image of images" [detail]="false">
      <ion-card>
        <ion-item>
          <ion-avatar slot="start">
            <img
              alt="DP"
              src="https://ionicframework.com/docs/img/demos/avatar.svg"
            />
          </ion-avatar>
          <ion-icon
            slot="end"
            name="ellipsis-horizontal-outline"
          ></ion-icon>
          <ion-label>
            <h2>{{ image.displayName || "devvscape_user" }}</h2>
          </ion-label>
        </ion-item>
    
        <div class="card" *ngIf="!imageLoaded">
          <ngx-shimmer-loading
            [width]="'100%'"
            [height]="'350px'"
          ></ngx-shimmer-loading>
        </div>
    
        <img
          [src]="image.imageUrl"
          [alt]="image.postText"
          (load)="imageLoaded = true"
        />
    
        <ion-card-header *ngIf="image.postText">
          <ion-card-subtitle>
            <b>{{ image.displayName || "devvscape_user" }}</b> {{ image.postText }}
          </ion-card-subtitle>
        </ion-card-header>
      </ion-card>
    </ion-item>
    <div class="no-posts" *ngIf="images?.length === 0">
      You have never committed a meme to the app repository
    </div>
  </ng-container>

  <ng-container *ngIf="selectedSegment === 'comments'">
    <div class="no-comments">
      Comment on some memes in the app repository to have them here
    </div>
  </ng-container>

  <ng-container *ngIf="selectedSegment === 'stars'">
    <div class="no-stars">
      Star on some memes in the app repository to have them here
    </div>
  </ng-container>
</ion-content>
